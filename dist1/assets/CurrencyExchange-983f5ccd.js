import{r as c,e as l,j as e,C as d,k as p,h as $,L as y,W as m}from"./index-882c3c42.js";import{I as j}from"./ImageWithFallback-377b87ce.js";import{r as g,t as F,a as N,f as h}from"./index-a1fb6659.js";const W=({label:t,value:s,selectHandler:r})=>{const{presentCurrency:a,fetchedCurrencyNames:_}=c.useContext(l);return e.jsxs(d,{className:p.container,children:[e.jsxs("label",{className:p.label,children:[" ",t,":"]}),e.jsx("select",{className:p.select,name:"baseCurrency",id:"baseCurrency",value:s,onChange:n=>{r(n.target.value)},children:Object.keys(_).filter(n=>n!==(a==null?void 0:a.currencyCode)).map(n=>e.jsx("option",{value:n,children:`${n} - ${_[n]}`},n))})]})};function z(t,s){g(2,arguments);var r=F(t),a=N(s);return isNaN(a)?new Date(NaN):(a&&r.setDate(r.getDate()+a),r)}function I(t,s){g(2,arguments);var r=N(s);return z(t,-r)}const v=()=>{const{presentCurrency:t,baseCurrency:s}=c.useContext(l),[r,a]=c.useState({date:{code:0}}),[_,n]=c.useState(!1);return c.useEffect(()=>{n(!0);const i=new Date,f=h(i,"yyyy-MM-dd"),b=h(I(i,12),"yyyy-MM-dd");$.get(`/${b}..${f}?from=${s}&to=${t?t.currencyCode:"USD"}`).then(H=>{a(H.data.rates),n(!1)})},[s,t]),{currencyHistory:r,inProgress:_}},L=c.memo(()=>{const{currencyBaseHandler:t,baseCurrency:s}=c.useContext(l),[r,a]=c.useState("");return c.useEffect(()=>{a(s)},[s]),e.jsx(W,{value:r,selectHandler:t,label:"Please choose your base currency..."})}),S="_display__Latest_tl9ha_1",D="_display__Flag_tl9ha_11",o={display__Latest:S,display__Flag:D,"latest-small":"_latest-small_tl9ha_19","latest-big":"_latest-big_tl9ha_25"},B=()=>{const t=c.useContext(l);if(!t)return e.jsx(y,{});const{presentCurrency:s,baseCurrency:r,latestCurrencyRates:a}=t;return e.jsx(e.Fragment,{children:e.jsx(d,{className:o.display__Latest,children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(j,{currencyCode:s.currencyCode,className:o.display__Flag})}),e.jsx("span",{className:o["latest-big"],children:`Latest ${s==null?void 0:s.currencyCode} to ${r} rate:  ${a[s.currencyCode]}`}),e.jsx("span",{className:o["latest-small"],children:`${s==null?void 0:s.currencyCode} to ${r} ${a[s.currencyCode]}`}),e.jsx("div",{children:e.jsx(j,{currencyCode:r,className:o.display__Flag})})]}):"Please choose currency to compare..."})})},O="_history__Item_ksjh1_1",k="_History__rate_ksjh1_19",w="_History__date_ksjh1_29",x={history__Item:O,History__rate:k,History__date:w},E=({date:t,presentCurrency:s,currencyRates:r})=>e.jsx(m,{className:x.history__Item,children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:x.History__date,children:t}),e.jsx("div",{className:x.History__rate,children:s&&JSON.stringify(r[s.currencyCode])})]})}),P="_display__History_e2iz3_3",M="_center_e2iz3_19",C={display__History:P,center:M},R=()=>{const t=c.useContext(l),{presentCurrency:s}=t,{currencyHistory:r,inProgress:a}=v();return r?e.jsx(e.Fragment,{children:a?e.jsx(d,{className:C.center,children:e.jsx(y,{})}):e.jsx(d,{className:C.display__History,children:Object.entries(r).map(([_,n],i)=>e.jsx(E,{date:_,presentCurrency:s,currencyRates:n},i)).reverse()})}):e.jsx(y,{})},q="_display__Wrapper_1b7uh_1",V={display__Wrapper:q},A=()=>{const{presentCurrency:t}=c.useContext(l);return e.jsxs(m,{className:V.display__Wrapper,children:[t?e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(R,{})]}):null,e.jsx(L,{})]})},J="_wrapper_1xybd_3",T="_exchange__Wrapper_1xybd_9",U={wrapper:J,exchange__Wrapper:T},G="_currency_19zz1_1",K="_currency__Button_19zz1_9",Q="_currency__Flag_19zz1_45",X="_currency__ItemSmall_19zz1_61",Y="_currency__Name_19zz1_73",Z="_selected_19zz1_113",u={currency:G,currency__Button:K,currency__Flag:Q,currency__ItemSmall:X,currency__Name:Y,selected:Z},ee=({currencyCode:t,currencyRate:s})=>{const r=c.useContext(l);if(!r)return e.jsx(y,{});const a=r.currencyButtonHandler,_=r.fetchedCurrencyNames;return e.jsxs("button",{className:u.currency__Button,onClick:()=>{a&&a(t)},children:[e.jsx(j,{currencyCode:t,className:u.currency__Flag}),e.jsx("span",{className:u.currency__ItemSmall,children:`${t} `}),e.jsx("span",{className:u.currency__Name,children:_[`${t}`]}),e.jsx("span",{className:u.currency__ItemSmall,children:s.toFixed(2)})]})},se="_list__Wrapper_qdvrh_1",te="_List__Wrapper_qdvrh_19",re={list__Wrapper:se,List__Wrapper:te},ae=()=>{const t=c.useContext(l);if(!t)return e.jsx(y,{});const s=t.latestCurrencyRates;return e.jsx(m,{className:re.list__Wrapper,children:Object.entries(s).map(([r,a])=>e.jsx(ee,{currencyCode:r,currencyRate:a},r))})},le=()=>(c.useEffect(()=>{},[]),e.jsxs(m,{className:U.wrapper,children:[e.jsx(A,{}),e.jsx(ae,{})]}));export{le as default};
